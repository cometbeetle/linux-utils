[dev]
# Use custom image.
image=dev-toolbox:latest
home=$HOME/.local/share/distrobox/home/dev
nvidia=true

# Pass in user UID and GID.
additional_flags="--env HOST_UID=$(id -u)"
additional_flags="--env HOST_GID=$(id -g)"

# Install user tools.
init_hooks="curl -LsSf https://astral.sh/uv/install.sh | sh"
init_hooks="curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y"

# Fix Vulkan issue on NVIDIA GPUs.
init_hooks="echo 'export VK_ICD_FILENAMES=/run/host/usr/share/vulkan/icd.d/nvidia_icd.x86_64.json' >> ~/.bashrc"

# Allow launching apps on the host system from within the container.
init_hooks="ln -sf /usr/bin/distrobox-host-exec /usr/bin/flatpak"
init_hooks="ln -sf /usr/bin/distrobox-host-exec /usr/bin/xdg-open"

# Link Git config & credentials to container.
init_hooks="[ -e $HOME/.gitconfig ] || { touch $HOME/.gitconfig && chown \$HOST_UID:\$HOST_GID $HOME/.gitconfig; }; ln -sf $HOME/.gitconfig ~ || true"
init_hooks="[ -e $HOME/.git-credentials ] || { touch $HOME/.git-credentials && chmod 600 $HOME/.git-credentials && chown \$HOST_UID:\$HOST_GID $HOME/.git-credentials; }; ln -sf $HOME/.git-credentials ~ || true"

# Link .netrc to container.
init_hooks="[ -e $HOME/.netrc ] || { touch $HOME/.netrc && chmod 600 $HOME/.netrc && chown \$HOST_UID:\$HOST_GID $HOME/.netrc; }; ln -sf $HOME/.netrc ~ || true"

# Ensure proper home directory permissions (must be done last).
init_hooks="chown -R \$HOST_UID:\$HOST_GID \$HOME"

# Export certain apps to host.
exported_apps="code /opt/jetbrains-toolbox/bin/jetbrains-toolbox.desktop"
